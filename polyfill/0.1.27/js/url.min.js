/*!
 * URL Polyfill
 * github.com/inexorabletash/polyfill/blob/master/url.js
 * Draft specification: https://url.spec.whatwg.org
 * Notes:
 *  - Primarily useful for parsing URLs and modifying query parameters
 *  - Should work in IE8+ and everything more modern
 * closure-compiler.appspot.com/code/jsc10ea121d004d9d23ba30d08f96fcb8c6/default.js
 */
(function(g){function p(a){var b="",d=!0;a.forEach(function(a){var c=encodeURIComponent(a.name);a=encodeURIComponent(a.value);d||(b+="&");b+=c+"="+a;d=!1});return b.replace(/%20/g,"+")}function q(a,b){var d=a.split("&");b&&-1===d[0].indexOf("=")&&(d[0]="="+d[0]);var f=[];d.forEach(function(a){if(0!==a.length){var b=a.indexOf("=");if(-1!==b){var e=a.substring(0,b);a=a.substring(b+1)}else e=a,a="";e=e.replace(/\+/g," ");a=a.replace(/\+/g," ");f.push({name:e,value:a})}});var c=[];f.forEach(function(a){c.push({name:decodeURIComponent(a.name),value:decodeURIComponent(a.value)})});return c}function t(a){if(l)return new h(a);var b=document.createElement("a");b.href=a;return b}function m(a){var b=this;this._list=[];if(void 0===a||null===a)a="";if(Object(a)!==a||a instanceof m)a=String(a);"string"===typeof a&&("?"===a.substring(0,1)&&(a=a.substring(1)),this._list=q(a));this._url_object=null;this._setList=function(a){d||(b._list=a)};var d=!1;this._update_steps=function(){d||(d=!0,b._url_object&&("about:"===b._url_object.protocol&&-1!==b._url_object.pathname.indexOf("?")&&(b._url_object.pathname=b._url_object.pathname.split("?")[0]),b._url_object.search=p(b._list),d=!1))}}function r(a,b){function d(){var a=c.href.replace(/#$|\?$|\?(?=#)/g,"");c.href!==a&&(c.href=a)}function f(){n._setList(c.search?q(c.search.substring(1)):[]);n._update_steps()}if(!(this instanceof g.URL))throw new TypeError("Failed to construct 'URL': Please use the 'new' operator.");b&&(a=function(){if(l)return(new h(a,b)).href;var e;document.implementation&&document.implementation.createHTMLDocument?e=document.implementation.createHTMLDocument(""):document.implementation&&document.implementation.createDocument?(e=document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",null),e.documentElement.appendChild(e.createElement("head")),e.documentElement.appendChild(e.createElement("body"))):window.ActiveXObject&&(e=new window.ActiveXObject("htmlfile"),e.write("<head></head><body></body>"),e.close());if(!e)throw Error("base not supported");var c=e.createElement("base");c.href=b;e.getElementsByTagName("head")[0].appendChild(c);e=e.createElement("a");e.href=a;return e.href}());var c=t(a||""),k=function(){if(!("defineProperties"in Object))return!1;try{var a={};Object.defineProperties(a,{prop:{get:function(){return!0}}});return a.prop}catch(b){return!1}}()?this:document.createElement("a"),n=new m(c.search?c.search.substring(1):null);n._url_object=k;Object.defineProperties(k,{href:{get:function(){return c.href},set:function(a){c.href=a;d();f()},enumerable:!0,configurable:!0},origin:{get:function(){return"origin"in c?c.origin:this.protocol+"//"+this.host},enumerable:!0,configurable:!0},protocol:{get:function(){return c.protocol},set:function(a){c.protocol=a},enumerable:!0,configurable:!0},username:{get:function(){return c.username},set:function(a){c.username=a},enumerable:!0,configurable:!0},password:{get:function(){return c.password},set:function(a){c.password=a},enumerable:!0,configurable:!0},host:{get:function(){var a={"http:":/:80$/,"https:":/:443$/,"ftp:":/:21$/}[c.protocol];return a?c.host.replace(a,""):c.host},set:function(a){c.host=a},enumerable:!0,configurable:!0},hostname:{get:function(){return c.hostname},set:function(a){c.hostname=a},enumerable:!0,configurable:!0},port:{get:function(){return c.port},set:function(a){c.port=a},enumerable:!0,configurable:!0},pathname:{get:function(){return"/"!==c.pathname.charAt(0)?"/"+c.pathname:c.pathname},set:function(a){c.pathname=a},enumerable:!0,configurable:!0},search:{get:function(){return c.search},set:function(a){c.search!==a&&(c.search=a,d(),f())},enumerable:!0,configurable:!0},searchParams:{get:function(){return n},enumerable:!0,configurable:!0},hash:{get:function(){return c.hash},set:function(a){c.hash=a;d()},enumerable:!0,configurable:!0},toString:{value:function(){return c.toString()},enumerable:!1,configurable:!0},valueOf:{value:function(){return c.valueOf()},enumerable:!1,configurable:!0}});return k}var h=g.URL,l;try{if(h){l=new g.URL("http://example.com");if("searchParams"in l)return;"href"in l||(l=void 0)}}catch(a){}Object.defineProperties(m.prototype,{append:{value:function(a,b){this._list.push({name:a,value:b});this._update_steps()},writable:!0,enumerable:!0,configurable:!0},"delete":{value:function(a){for(var b=0;b<this._list.length;)this._list[b].name===a?this._list.splice(b,1):++b;this._update_steps()},writable:!0,enumerable:!0,configurable:!0},get:{value:function(a){for(var b=0;b<this._list.length;++b)if(this._list[b].name===a)return this._list[b].value;return null},writable:!0,enumerable:!0,configurable:!0},getAll:{value:function(a){for(var b=[],d=0;d<this._list.length;++d)this._list[d].name===a&&b.push(this._list[d].value);return b},writable:!0,enumerable:!0,configurable:!0},has:{value:function(a){for(var b=0;b<this._list.length;++b)if(this._list[b].name===a)return!0;return!1},writable:!0,enumerable:!0,configurable:!0},set:{value:function(a,b){for(var d=!1,f=0;f<this._list.length;)this._list[f].name===a?d?this._list.splice(f,1):(this._list[f].value=b,d=!0,++f):++f;d||this._list.push({name:a,value:b});this._update_steps()},writable:!0,enumerable:!0,configurable:!0},entries:{value:function(){var a=this,b=0;return{next:function(){if(b>=a._list.length)return{done:!0,value:void 0};var d=a._list[b++];return{done:!1,value:[d.name,d.value]}}}},writable:!0,enumerable:!0,configurable:!0},keys:{value:function(){var a=this,b=0;return{next:function(){return b>=a._list.length?{done:!0,value:void 0}:{done:!1,value:a._list[b++].name}}}},writable:!0,enumerable:!0,configurable:!0},values:{value:function(){var a=this,b=0;return{next:function(){return b>=a._list.length?{done:!0,value:void 0}:{done:!1,value:a._list[b++].value}}}},writable:!0,enumerable:!0,configurable:!0},forEach:{value:function(a){var b=1<arguments.length?arguments[1]:void 0;this._list.forEach(function(d,f){a.call(b,d.value,d.name)})},writable:!0,enumerable:!0,configurable:!0},toString:{value:function(){return p(this._list)},writable:!0,enumerable:!1,configurable:!0}});"Symbol"in g&&"iterator"in g.Symbol&&Object.defineProperty(m.prototype,g.Symbol.iterator,{value:m.prototype.entries,writable:!0,enumerable:!0,configurable:!0});if(h)for(var k in h)h.hasOwnProperty(k)&&"function"===typeof h[k]&&(r[k]=h[k]);g.URL=r;g.URLSearchParams=m})(self);

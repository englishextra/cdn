/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   3.2.2+39aa2571
 */
;(function(){function S(){return function(){process.nextTick(l)}}function T(){return function(){H(l)}}function U(){var a=0,b=new I(l),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=a=++a%2}}function V(){var a=new MessageChannel;a.port1.onmessage=l;return function(){a.port2.postMessage(0)}}function J(){return function(){setTimeout(l,1)}}function l(){for(var a=0;a<n;a+=2)(0,p[a])(p[a+1]),p[a]=void 0,p[a+1]=void 0;n=0}function W(){try{var a=require("vertx");H=a.runOnLoop||a.runOnContext;return T()}catch(b){return J()}}function q(){}function K(a){try{return a.then}catch(b){return y.error=b,y}}function X(a,b,c,d){try{a.call(b,c,d)}catch(f){return f}}function Y(a,b,c){k(function(a){var f=!1,e=X(c,b,function(c){f||(f=!0,b!==c?u(a,c):m(a,c))},function(b){f||(f=!0,h(a,b))},"Settle: "+(a._label||" unknown promise"));!f&&e&&(f=!0,h(a,e))},a)}function Z(a,b){b._state===v?m(a,b._result):b._state===r?h(a,b._result):B(b,void 0,function(b){u(a,b)},function(b){h(a,b)})}function L(a,b,c){b.constructor===a.constructor&&c===C&&constructor.resolve===D?Z(a,b):c===y?h(a,y.error):void 0===c?m(a,b):"function"===typeof c?Y(a,b,c):m(a,b)}function u(a,b){a===b?h(a,new TypeError("You cannot resolve a promise with itself")):"function"===typeof b||"object"===typeof b&&null!==b?L(a,b,K(b)):m(a,b)}function aa(a){a._onerror&&a._onerror(a._result);E(a)}function m(a,b){a._state===t&&(a._result=b,a._state=v,0!==a._subscribers.length&&k(E,a))}function h(a,b){a._state===t&&(a._state=r,a._result=b,k(aa,a))}function B(a,b,c,d){var f=a._subscribers,e=f.length;a._onerror=null;f[e]=b;f[e+v]=c;f[e+r]=d;0===e&&a._state&&k(E,a)}function E(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,f,e=a._result,g=0;g<b.length;g+=3)d=b[g],f=b[g+c],d?M(c,d,f,e):f(e);a._subscribers.length=0}}function N(){this.error=null}function M(a,b,c,d){var f="function"===typeof c,e,g,k,l;if(f){try{e=c(d)}catch(n){F.error=n,e=F}e===F?(l=!0,g=e.error,e=null):k=!0;if(b===e){h(b,new TypeError("A promises callback cannot return that same promise."));return}}else e=d,k=!0;b._state===t&&(f&&k?u(b,e):l?h(b,g):a===v?m(b,e):a===r&&h(b,e))}function ba(a,b){try{b(function(b){u(a,b)},function(b){h(a,b)})}catch(c){h(a,c)}}function O(a){a[z]=P++;a._state=void 0;a._result=void 0;a._subscribers=[]}function g(a){this[z]=P++;this._result=this._state=void 0;this._subscribers=[];if(q!==a){if("function"!==typeof a)throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(this instanceof g)ba(this,a);else throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}}function w(a,b){this._instanceConstructor=a;this.promise=new a(q);this.promise[z]||O(this.promise);Q(b)?(this._input=b,this._remaining=this.length=b.length,this._result=Array(this.length),0===this.length?m(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&m(this.promise,this._result))):h(this.promise,Error("Array Methods must be provided an Array"))}var Q=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},n=0,H,G,k=function(a,b){p[n]=a;p[n+1]=b;n+=2;2===n&&(G?G(l):R())},x="undefined"!==typeof window?window:void 0,A=x||{},I=A.MutationObserver||A.WebKitMutationObserver,A="undefined"===typeof self&&"undefined"!==typeof process&&"[object process]"==={}.toString.call(process),ca="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,p=Array(1E3),R;R=A?S():I?U():ca?V():void 0===x&&"function"===typeof require?W():J();var C=function(a,b){var c=this,d=new this.constructor(q);void 0===d[z]&&O(d);var f=c._state;if(f){var e=arguments[f-1];k(function(){M(f,d,e,c._result)})}else B(c,d,a,b);return d},D=function(a){if(a&&"object"===typeof a&&a.constructor===this)return a;var b=new this(q);u(b,a);return b},z=Math.random().toString(36).substring(16),t=void 0,v=1,r=2,y=new N,F=new N,P=0;g.all=function(a){return(new da(this,a)).promise};g.race=function(a){var b=this;return Q(a)?new b(function(c,d){for(var f=a.length,e=0;e<f;e++)b.resolve(a[e]).then(c,d)}):new b(function(a,b){b(new TypeError("You must pass an array to race."))})};g.resolve=D;g.reject=function(a){var b=new this(q);h(b,a);return b};g._setScheduler=function(a){G=a};g._setAsap=function(a){k=a};g._asap=k;g.prototype={constructor:g,then:C,"catch":function(a){return this.then(null,a)}};var da=w;w.prototype._enumerate=function(){for(var a=this.length,b=this._input,c=0;this._state===t&&c<a;c++)this._eachEntry(b[c],c)};w.prototype._eachEntry=function(a,b){var c=this._instanceConstructor,d=c.resolve;d===D?(d=K(a),d===C&&a._state!==t?this._settledAt(a._state,b,a._result):"function"!==typeof d?(this._remaining--,this._result[b]=a):c===g?(c=new c(q),L(c,a,d),this._willSettleAt(c,b)):this._willSettleAt(new c(function(b){b(a)}),b)):this._willSettleAt(d(a),b)};w.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===t&&(this._remaining--,a===r?h(d,c):this._result[b]=c);0===this._remaining&&m(d,this._result)};w.prototype._willSettleAt=function(a,b){var c=this;B(a,void 0,function(a){c._settledAt(v,b,a)},function(a){c._settledAt(r,b,a)})};x=function(){var a;if("undefined"!==typeof global)a=global;else if("undefined"!==typeof self)a=self;else try{a=Function("return this")()}catch(c){throw Error("polyfill failed because global object is unavailable in this environment");}var b=a.Promise;if(!b||"[object Promise]"!==Object.prototype.toString.call(b.resolve())||b.cast)a.Promise=g};g.Promise=g;g.polyfill=x;"function"===typeof define&&define.amd?define(function(){return g}):"undefined"!==typeof module&&module.exports?module.exports=g:"undefined"!==typeof this&&(this.Promise=g);x()}).call(this);

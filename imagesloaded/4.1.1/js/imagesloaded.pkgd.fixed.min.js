/*!
 * imagesLoaded PACKAGED v4.1.1
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 * removed AMD, CommonJS support
 * changed this or global to window as argument
 * added if("undefined"==typeof window||!("document"in window))
 * {return console.log("window is undefined or document is not in window"),!1;}
 * wont't pass jshint
 * closure-compiler.appspot.com/code/jsc791a430ae9a0fab140f8a5be98233036/default.js
 */
;(function(f,h){if("undefined"==typeof window||!("document"in window))return console.log("window is undefined or document is not in window"),!1;window.EvEmitter=h()})(window,function(){function f(){}var h=f.prototype;h.on=function(d,g){if(d&&g){var a=this._events=this._events||{},a=a[d]=a[d]||[];-1==a.indexOf(g)&&a.push(g);return this}};h.once=function(d,g){if(d&&g){this.on(d,g);var a=this._onceEvents=this._onceEvents||{};(a[d]=a[d]||{})[g]=!0;return this}};h.off=function(d,g){var a=this._events&&this._events[d];if(a&&a.length){var e=a.indexOf(g);-1!=e&&a.splice(e,1);return this}};h.emitEvent=function(d,g){var a=this._events&&this._events[d];if(a&&a.length){var e=0,k=a[e];g=g||[];for(var f=this._onceEvents&&this._onceEvents[d];k;){var h=f&&f[k];h&&(this.off(d,k),delete f[k]);k.apply(this,g);e+=h?0:1;k=a[e]}return this}};return f});(function(f,h){f.imagesLoaded=h(f,f.EvEmitter)})(window,function(f,h){function d(b,c){for(var a in c)b[a]=c[a];return b}function g(b){var c=[];if(Array.isArray(b))c=b;else if("number"==typeof b.length)for(var a=0;a<b.length;a++)c.push(b[a]);else c.push(b);return c}function a(b,c,l){if(!(this instanceof a))return new a(b,c,l);"string"==typeof b&&(b=document.querySelectorAll(b));this.elements=g(b);this.options=d({},this.options);"function"==typeof c?l=c:d(this.options,c);if(l)this.on("always",l);this.getImages();m&&(this.jqDeferred=new m.Deferred);setTimeout(function(){this.check()}.bind(this))}function e(b){this.img=b}function k(b,c){this.url=b;this.element=c;this.img=new Image}var m=f.jQuery,n=f.console;a.prototype=Object.create(h.prototype);a.prototype.options={};a.prototype.getImages=function(){this.images=[];this.elements.forEach(this.addElementImages,this)};a.prototype.addElementImages=function(b){"IMG"==b.nodeName&&this.addImage(b);!0===this.options.background&&this.addElementBackgroundImages(b);var c=b.nodeType;if(c&&p[c]){for(var a=b.querySelectorAll("img"),c=0;c<a.length;c++)this.addImage(a[c]);if("string"==typeof this.options.background)for(b=b.querySelectorAll(this.options.background),c=0;c<b.length;c++)this.addElementBackgroundImages(b[c])}};var p={1:!0,9:!0,11:!0};a.prototype.addElementBackgroundImages=function(b){var a=getComputedStyle(b);if(a)for(var l=/url\((['"])?(.*?)\1\)/gi,d=l.exec(a.backgroundImage);null!==d;)(d=d&&d[2])&&this.addBackground(d,b),d=l.exec(a.backgroundImage)};a.prototype.addImage=function(b){b=new e(b);this.images.push(b)};a.prototype.addBackground=function(b,a){var c=new k(b,a);this.images.push(c)};a.prototype.check=function(){function b(b,c,d){setTimeout(function(){a.progress(b,c,d)})}var a=this;this.progressedCount=0;this.hasAnyBroken=!1;this.images.length?this.images.forEach(function(a){a.once("progress",b);a.check()}):this.complete()};a.prototype.progress=function(b,a,d){this.progressedCount++;this.hasAnyBroken=this.hasAnyBroken||!b.isLoaded;this.emitEvent("progress",[this,b,a]);this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,b);this.progressedCount==this.images.length&&this.complete();this.options.debug&&n&&n.log("progress: "+d,b,a)};a.prototype.complete=function(){var b=this.hasAnyBroken?"fail":"done";this.isComplete=!0;this.emitEvent(b,[this]);this.emitEvent("always",[this]);if(this.jqDeferred)this.jqDeferred[this.hasAnyBroken?"reject":"resolve"](this)};e.prototype=Object.create(h.prototype);e.prototype.check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)};e.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth};e.prototype.confirm=function(b,a){this.isLoaded=b;this.emitEvent("progress",[this,this.img,a])};e.prototype.handleEvent=function(a){var b="on"+a.type;if(this[b])this[b](a)};e.prototype.onload=function(){this.confirm(!0,"onload");this.unbindEvents()};e.prototype.onerror=function(){this.confirm(!1,"onerror");this.unbindEvents()};e.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this);this.proxyImage.removeEventListener("error",this);this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)};k.prototype=Object.create(e.prototype);k.prototype.check=function(){this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.img.src=this.url;this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())};k.prototype.unbindEvents=function(){this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)};k.prototype.confirm=function(a,c){this.isLoaded=a;this.emitEvent("progress",[this,this.element,c])};a.makeJQueryPlugin=function(b){if(b=b||f.jQuery)m=b,m.fn.imagesLoaded=function(b,d){return(new a(this,b,d)).jqDeferred.promise(m(this))}};a.makeJQueryPlugin();return a});
